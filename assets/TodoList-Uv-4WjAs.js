import{u as z,r,c as m,o as I,b as n,d as l,e as t,t as c,k as $,w as x,v as O,n as k,F as A,l as V,f as p,m as B}from"./index-BTii5yc3.js";import{a as v}from"./axios-C8DqakIB.js";const D={id:"todoListPage",class:"bg-half"},M=t("h1",null,[t("a",{href:"#"},"ONLINE TODO LIST")],-1),U={class:"todo_sm"},F={href:"#"},J={class:"conatiner todoListPage vhContainer"},P={class:"todoList_Content"},R={class:"inputBox"},W=t("i",{class:"fa fa-plus"},"+",-1),X=[W],j={key:0,class:"todoList_list"},q={class:"todoList_tab"},G={class:"todoList_items"},H={class:"todoList_item"},K=["onClick"],Q=["onUpdate:modelValue"],Y={key:1},Z=["onClick"],tt=t("i",{class:"fa fa-times"},"X",-1),et=[tt],st={class:"todoList_statistics"},ot={key:0},at={key:1},nt={key:2},lt={key:1},it=t("div",null,"目前尚無待辦事項",-1),ut=[it],h="https://todolist-api.hexschool.io",vt={__name:"TodoList",setup(ct){const g=z(),i=r([]),d=r({content:""}),y=r([]),u=r([]),_=async()=>{const e=await v.get(`${h}/todos`,{headers:{Authorization:u.value}});i.value=e.data.data,i.value.forEach(s=>{s.tmpContent=s.content,s.editState=!1})},T=async()=>{d.value.content!=""&&v.post(h+"/todos",d.value,{headers:{Authorization:u.value}}).then(()=>{_(),d.value.content=""}).catch(e=>{console.log(e)})},b=async e=>{await v.delete(`${h}/todos/${e}`,{headers:{Authorization:u.value}}),_()},w=async()=>{try{await v.post(`${h}/users/sign_out`,{},{headers:{Authorization:u.value}}),u.value="",document.cookie="authInfo=;max-age=0;",g.push("/login")}catch(e){console.log(e)}},S=async e=>{await v.patch(`${h}/todos/${e}/toggle`,{},{headers:{Authorization:u.value}}),_()},a=r("all"),E=m(()=>{let e=[];return a.value=="all"?i.value:a.value=="done"?(i.value.forEach(s=>{s.status==!0&&e.push(s)}),e):(a.value=="incomplete"&&i.value.forEach(s=>{s.status==!1&&e.push(s)}),e)}),C=m(()=>{let e=0;return i.value.forEach(s=>{s.status==!0&&e++}),e}),L=m(()=>{let e=0;return i.value.forEach(s=>{s.status==!1&&e++}),e});return I(()=>{var s;const e=(s=document.cookie.split("; ").find(o=>o.startsWith("authInfo=")))==null?void 0:s.split("=")[1];e?(y.value=JSON.parse(e).user,u.value=JSON.parse(e).token,_()):g.push("/login")}),(e,s)=>(n(),l("div",D,[t("nav",null,[M,t("ul",null,[t("li",U,[t("a",F,[t("span",null,c(y.value)+" 的代辦事項表",1)])]),t("li",null,[t("a",{href:"#",onClick:$(w,["prevent"])},"登出")])])]),t("div",J,[t("div",P,[t("div",R,[x(t("input",{"onUpdate:modelValue":s[0]||(s[0]=o=>d.value.content=o),type:"text",placeholder:"請輸入待辦事項"},null,512),[[O,d.value.content]]),t("a",{href:"#",onClick:$(T,["prevent"])},X)]),i.value.length>0?(n(),l("div",j,[t("ul",q,[t("li",null,[t("a",{class:k({active:a.value=="all"}),onClick:s[1]||(s[1]=o=>a.value="all")},"全部",2)]),t("li",null,[t("a",{class:k({active:a.value=="incomplete"}),onClick:s[2]||(s[2]=o=>a.value="incomplete")},"待完成",2)]),t("li",null,[t("a",{class:k({active:a.value=="done"}),onClick:s[3]||(s[3]=o=>a.value="done")},"已完成",2)])]),t("div",G,[t("ul",H,[(n(!0),l(A,null,V(E.value,(o,N)=>(n(),l("li",{key:N},[o.editState==!1?(n(),l("label",{key:0,class:"todoList_label",onClick:f=>S(o.id)},[x(t("input",{class:"todoList_input",type:"checkbox","onUpdate:modelValue":f=>o.status=f},null,8,Q),[[B,o.status]]),t("span",null,c(o.content),1)],8,K)):p("",!0),o.editState==!1?(n(),l("div",Y,[t("a",{onClick:f=>b(o.id)},et,8,Z)])):p("",!0)]))),128))]),t("div",st,[a.value=="done"?(n(),l("p",ot,c(C.value)+" 個已完成項目。",1)):a.value=="incomplete"?(n(),l("p",at,c(L.value)+" 個未完成項目。",1)):p("",!0),a.value=="all"?(n(),l("p",nt,c(C.value)+" 個已完成項目，"+c(L.value)+" 個未完成項目。 ",1)):p("",!0)])])])):(n(),l("div",lt,ut))])])]))}};export{vt as default};
